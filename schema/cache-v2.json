{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$comment": "Version 2.0",
  "title": "Benchmark results",
  "description": "Aggregated data from all the JMH benchmark runs",
  "type": "object",
  "properties": {
    "$schema": {
      "type": "string",
      "description": "Schema specification URI",
      "format": "uri"
    },
    "configuration": {
      "type": "object",
      "description": "Benchmark configuration - HW, OS, JVM, etc.",
      "properties": {
        "osName": {
          "type": "string",
          "description": "Operating system name, as reported by the `os.name` system property"
        },
        "osArch": {
          "type": "string",
          "description": "Operating system architecture, as reported by the `os.arch` system property"
        },
        "osVersion": {
          "type": "string"
        },
        "vmName": {
          "type": "string",
          "description": "`java.vm.name` system property"
        },
        "vmVersion": {
          "type": "string",
          "description": "`java.vm.version` system property"
        },
        "vmVendor": {
          "type": "string",
          "description": "`java.vm.vendor` system property"
        },
        "jdkVersion": {
          "type": "string"
        }
      },
      "required": [
        "osName",
        "osArch",
        "vmName",
        "vmVersion",
        "vmVendor",
        "jdkVersion"
      ]
    },
    "gh_action_run": {
      "type": ["object", "null"],
      "description": "Details about the benchmark GitHub Action run. On local run, can be null. If run on the CI, must not be null.",
      "properties": {
        "id": {
          "type": "string",
          "description": "The GitHub Action run ID"
        },
        "html_url": {
          "type": "string",
          "format": "uri"
        },
        "run_attempt": {
          "type": "integer"
        },
        "event": {
          "type": "string"
        },
        "display_title": {
          "type": "string"
        },
        "head_commit": {
          "type": "object",
          "description": "The commit on which the benchmarks were run",
          "properties": {
            "id": {
              "type": "string"
            },
            "message": {
              "type": "string"
            },
            "timestamp": {
              "type": "string",
              "format": "date-time"
            },
            "author": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string"
                }
              },
              "required": [
                "name"
              ]
            },
            "branch": {
              "type": "string"
            },
            "url": {
              "type": "string",
              "format": "uri"
            }
          },
          "required": [
            "id",
            "message",
            "timestamp",
            "author",
            "branch"
          ]
        }
      },
      "required": [
        "id",
        "html_url",
        "run_attempt",
        "event",
        "display_title",
        "head_commit"
      ]
    },
    "results": {
      "type": "array",
      "description": "List of benchmark results",
      "items": {
        "type": "object",
        "properties": {
          "label": {
            "type": "string",
            "description": "Benchmark label - name of the benchmark"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          },
          "score": {
            "type": "number",
            "description": "Benchmark score - Average operation time, i.e., how many milliseconds it takes for a single iteration. Lower is better."
          },
          "samples": {
            "type": "number",
            "description": "Number of measurement iterations (samples taken)"
          },
          "warmupIterations": {
            "type": "integer",
            "description": "The number of warmup iterations"
          },
          "warmupMillis": {
            "type": "integer",
            "description": "The number of milliseconds per warmup iteration"
          },
          "measureIterations": {
            "type": "integer",
            "description": "The number of measurement iterations. Usually is the same as number of samples."
          },
          "measureMillis": {
            "type": "integer",
            "description": "The number of milliseconds per measurement iteration"
          },
          "commitId": {
            "type": "string"
          },
          "branch": {
            "type": "string",
            "description": "Branch name (the current Git reference)"
          },
          "measurementStatistics": {
            "type": "object",
            "description": "Measurement statistics from the JMH's primary result",
            "properties": {
              "stddev": {
                "type": ["number", "string"],
                "description": "Standard deviation of the primary result",
                "enum": ["NaN"]
              },
              "mean": {
                "type": "number",
                "description": "Mean of the primary result"
              },
              "min": {
                "type": "number",
                "description": "Minimum value of the primary result"
              },
              "max": {
                "type": "number",
                "description": "Maximum value of the primary result"
              },
              "error50": {
                "type": ["number", "string"],
                "description": "Error margin at 50% confidence level",
                "enum": ["NaN"]
              },
              "error95": {
                "type": ["number", "string"],
                "description": "Error margin at 95% confidence level",
                "enum": ["NaN"]
              },
              "percentiles": {
                "type": "array",
                "description": "Percentile values",
                "uniqueItems": true,
                "items": {
                  "type": "object",
                  "properties": {
                    "value": {
                      "type": "number",
                      "description": "Percentile value"
                    },
                    "percentile": {
                      "type": "number",
                      "description": "Percentile"
                    }
                  }
                },
                "required": [
                  "value",
                  "percentile"
                ]
              }
            },
            "required": [
              "stddev",
              "mean",
              "min",
              "max",
              "error50",
              "error95",
              "percentiles"
            ]
          }
        },
        "required": [
          "label",
          "timestamp",
          "score",
          "samples",
          "warmupIterations",
          "warmupMillis",
          "measureMillis",
          "commitId",
          "branch",
          "measurementStatistics"
        ]
      }
    }
  },
  "required": [
    "$schema",
    "configuration",
    "gh_action_run",
    "results"
  ]
}